!function(t){"use strict";t.fn.lightbox=function(i){var e={margin:50,nav:!0,blur:!0,minSize:0},n={items:[],lightbox:null,image:null,current:null,locked:!1,caption:null,init:function(i){n.items=i;var o="lightbox-"+Math.floor(1e5*Math.random()+1);t("body").append('<div id="'+o+'" class="lightbox" style="display:none;"><a href="#" class="lightbox__close lightbox__button"></a><a href="#" class="lightbox__nav lightbox__nav--prev lightbox__button"></a><a href="#" class="lightbox__nav lightbox__nav--next lightbox__button"></a><div href="#" class="lightbox__caption"><p></p></div></div>'),n.lightbox=t("#"+o),n.caption=t(".lightbox__caption",n.lightbox),n.items.length>1&&e.nav?t(".lightbox__nav",n.lightbox).show():t(".lightbox__nav",n.lightbox).hide(),n.bindEvents()},loadImage:function(){e.blur&&t("body").addClass("blurred"),t("img",n.lightbox).remove(),n.lightbox.fadeIn("fast").append('<span class="lightbox__loading"></span>');var i=t('<img src="'+t(n.current).attr("href")+'" draggable="false">');n.setCaption(),t(i).on("load",function(){t(".lightbox__loading").remove(),n.lightbox.append(i),n.image=t("img",n.lightbox).hide(),n.resizeImage()})},setCaption:function(){var i=t(n.current).data("caption");i&&i.length>0?(n.caption.fadeIn(),t("p",n.caption).text(i)):n.caption.hide()},resizeImage:function(){var i,o,l,a,r;o=t(window).height()-e.margin,l=t(window).outerWidth(!0)-e.margin,n.image.width("").height(""),a=n.image.height(),(r=n.image.width())>l&&(i=l/r,r=l,a=Math.round(a*i)),a>o&&(i=o/a,a=o,r=Math.round(r*i)),n.image.width(r).height(a).css({top:(t(window).height()-n.image.outerHeight())/2+"px",left:(t(window).width()-n.image.outerWidth())/2+"px"}).show(),n.locked=!1},getCurrentIndex:function(){return t.inArray(n.current,n.items)},next:function(){if(n.locked)return!1;n.locked=!0,n.getCurrentIndex()>=n.items.length-1?t(n.items[0]).click():t(n.items[n.getCurrentIndex()+1]).click()},previous:function(){if(n.locked)return!1;n.locked=!0,n.getCurrentIndex()<=0?t(n.items[n.items.length-1]).click():t(n.items[n.getCurrentIndex()-1]).click()},bindEvents:function(){t(n.items).click(function(i){if(n.lightbox.is(":visible")||!(t(window).width()<e.minSize||t(window).height()<e.minSize)){var o=t(this)[0];i.preventDefault(),n.current=o,n.loadImage(),t(document).on("keydown",function(t){27===t.keyCode&&n.close(),39===t.keyCode&&n.next(),37===t.keyCode&&n.previous()})}else t(this).attr("target","_blank")}),n.lightbox.on("click",function(t){this===t.target&&n.close()}),t(n.lightbox).on("click",".lightbox__nav--prev",function(){return n.previous(),!1}),t(n.lightbox).on("click",".lightbox__nav--next",function(){return n.next(),!1}),t(n.lightbox).on("click",".lightbox__close",function(){return n.close(),!1}),t(window).resize(function(){n.image&&n.resizeImage()})},close:function(){t(document).off("keydown"),t(n.lightbox).fadeOut("fast"),t("body").removeClass("blurred")}};t.extend(e,i),n.init(this)}}(jQuery);